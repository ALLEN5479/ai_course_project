# AI课程系统任务管理接口文档

## 基础信息
- 后端服务地址：`http://localhost:8080`
- 请求方式：RESTful API
- 数据格式：JSON
- 跨域支持：已配置

## 通用响应格式
```json
{
  "success": true/false,
  "data": {}, // 响应数据
  "message": "操作结果描述"
}
```

---

## 1. 任务库管理接口

### 1.1 获取任务库列表
- **接口地址**：`GET /api/task-library/missions`
- **功能描述**：获取所有活跃的任务模板
- **响应示例**：
```json
{
  "success": true,
  "data": [
    {
      "missionId": 1,
      "missionName": "Python基础练习",
      "missionDescription": "学习Python基础语法",
      "content": "完成Python基础语法练习...",
      "createTime": "2024-01-01T10:00:00",
      "teacherId": 1,
      "missionType": "practice",
      "status": 1
    }
  ],
  "message": "获取任务库列表成功"
}
```

### 1.2 获取任务详情
- **接口地址**：`GET /api/task-library/missions/{missionId}`
- **功能描述**：根据任务ID获取任务详情
- **路径参数**：`missionId` - 任务ID

### 1.3 按类型获取任务
- **接口地址**：`GET /api/task-library/missions/type/{missionType}`
- **功能描述**：根据任务类型获取任务列表
- **路径参数**：`missionType` - 任务类型

### 1.4 获取教师任务
- **接口地址**：`GET /api/task-library/missions/teacher/{teacherId}`
- **功能描述**：获取指定教师创建的任务
- **路径参数**：`teacherId` - 教师ID

### 1.5 创建任务
- **接口地址**：`POST /api/task-library/missions`
- **功能描述**：创建新的任务模板
- **请求体**：
```json
{
  "missionName": "任务名称",
  "missionDescription": "任务描述",
  "content": "任务内容",
  "teacherId": 1,
  "missionType": "practice"
}
```

### 1.6 更新任务
- **接口地址**：`PUT /api/task-library/missions/{missionId}`
- **功能描述**：更新任务模板信息
- **路径参数**：`missionId` - 任务ID

### 1.7 删除任务
- **接口地址**：`DELETE /api/task-library/missions/{missionId}`
- **功能描述**：软删除任务模板（设置状态为0）
- **路径参数**：`missionId` - 任务ID

---

## 2. 任务管理接口

### 2.1 获取已发布任务列表
- **接口地址**：`GET /api/task-manager/published-missions`
- **功能描述**：获取所有已发布的任务
- **响应示例**：
```json
{
  "success": true,
  "data": [
    {
      "id": 1,
      "missionId": 1,
      "startTime": "2024-01-01T10:00:00",
      "endTime": "2024-01-07T23:59:59",
      "status": "active",
      "createTime": "2024-01-01T09:00:00"
    }
  ],
  "message": "获取已发布任务列表成功"
}
```

### 2.2 获取已发布任务详情
- **接口地址**：`GET /api/task-manager/published-missions/{id}`
- **功能描述**：根据ID获取已发布任务详情
- **路径参数**：`id` - 已发布任务ID

### 2.3 获取任务发布记录
- **接口地址**：`GET /api/task-manager/published-missions/mission/{missionId}`
- **功能描述**：获取指定任务的所有发布记录
- **路径参数**：`missionId` - 任务ID

### 2.4 按状态获取已发布任务
- **接口地址**：`GET /api/task-manager/published-missions/status/{status}`
- **功能描述**：根据状态获取已发布任务列表
- **路径参数**：`status` - 任务状态（pending/active/completed）

### 2.5 发布任务
- **接口地址**：`POST /api/task-manager/publish-mission`
- **功能描述**：发布任务
- **请求体**：
```json
{
  "missionId": 1,
  "startTime": "2024-01-01T10:00:00",
  "endTime": "2024-01-07T23:59:59"
}
```

### 2.6 更新已发布任务
- **接口地址**：`PUT /api/task-manager/published-missions/{id}`
- **功能描述**：更新已发布任务信息
- **路径参数**：`id` - 已发布任务ID

### 2.7 更新任务状态
- **接口地址**：`PUT /api/task-manager/published-missions/{id}/status`
- **功能描述**：更新已发布任务状态
- **路径参数**：`id` - 已发布任务ID
- **查询参数**：`status` - 新状态

### 2.8 删除已发布任务
- **接口地址**：`DELETE /api/task-manager/published-missions/{id}`
- **功能描述**：删除已发布任务
- **路径参数**：`id` - 已发布任务ID

---

## 3. 任务批改接口

### 3.1 获取任务提交列表
- **接口地址**：`GET /api/task-grading/submissions/{publishedMissionId}`
- **功能描述**：获取指定已发布任务的所有提交
- **路径参数**：`publishedMissionId` - 已发布任务ID
- **响应示例**：
```json
{
  "success": true,
  "data": [
    {
      "submissionId": 1,
      "publishedMissionId": 1,
      "studentId": 1,
      "submitTime": "2024-01-05T15:30:00",
      "submitStatus": "submitted",
      "gradeStatus": "pending",
      "score": null,
      "filePath": "/uploads/submission1.pdf",
      "fileName": "submission1.pdf",
      "fileSize": "2.5MB",
      "comment": null,
      "gradeTime": null,
      "graderId": null
    }
  ],
  "message": "获取任务提交列表成功"
}
```

### 3.2 按提交状态获取提交
- **接口地址**：`GET /api/task-grading/submissions/{publishedMissionId}/submit-status/{submitStatus}`
- **功能描述**：根据提交状态获取任务提交列表
- **路径参数**：
  - `publishedMissionId` - 已发布任务ID
  - `submitStatus` - 提交状态（not_submitted/submitted）

### 3.3 按批改状态获取提交
- **接口地址**：`GET /api/task-grading/submissions/{publishedMissionId}/grade-status/{gradeStatus}`
- **功能描述**：根据批改状态获取任务提交列表
- **路径参数**：
  - `publishedMissionId` - 已发布任务ID
  - `gradeStatus` - 批改状态（pending/graded）

### 3.4 获取提交详情
- **接口地址**：`GET /api/task-grading/submission/{submissionId}`
- **功能描述**：获取指定提交的详情
- **路径参数**：`submissionId` - 提交ID

### 3.5 批改单个提交
- **接口地址**：`PUT /api/task-grading/grade/{submissionId}`
- **功能描述**：批改单个任务提交
- **路径参数**：`submissionId` - 提交ID
- **请求体**：
```json
{
  "score": 85,
  "comment": "完成得很好，继续加油！",
  "gradeStatus": "graded",
  "graderId": 1
}
```

### 3.6 批量批改
- **接口地址**：`PUT /api/task-grading/batch-grade/{publishedMissionId}`
- **功能描述**：批量批改任务提交
- **路径参数**：`publishedMissionId` - 已发布任务ID
- **查询参数**：
  - `submissionIds` - 提交ID列表
  - `score` - 分数
  - `comment` - 评语（可选）
  - `graderId` - 批改人ID

---

## 4. 试卷管理接口

### 4.1 获取试卷列表
- **接口地址**：`GET /api/papers`
- **功能描述**：获取所有试卷
- **响应示例**：
```json
{
  "success": true,
  "data": [
    {
      "paperId": 1,
      "paperName": "Python基础测试",
      "paperDescription": "测试Python基础知识点",
      "totalScore": 100
    }
  ],
  "message": "获取试卷列表成功"
}
```

### 4.2 获取试卷详情
- **接口地址**：`GET /api/papers/{paperId}`
- **功能描述**：根据试卷ID获取试卷详情
- **路径参数**：`paperId` - 试卷ID

### 4.3 创建试卷
- **接口地址**：`POST /api/papers`
- **功能描述**：创建新试卷
- **请求体**：
```json
{
  "paperName": "试卷名称",
  "paperDescription": "试卷描述",
  "totalScore": 100
}
```

### 4.4 更新试卷
- **接口地址**：`PUT /api/papers/{paperId}`
- **功能描述**：更新试卷信息
- **路径参数**：`paperId` - 试卷ID

### 4.5 删除试卷
- **接口地址**：`DELETE /api/papers/{paperId}`
- **功能描述**：删除试卷
- **路径参数**：`paperId` - 试卷ID

---

## 5. 试卷题目管理接口

### 5.1 获取试卷题目列表
- **接口地址**：`GET /api/paper-questions/paper/{paperId}`
- **功能描述**：获取指定试卷的所有题目
- **路径参数**：`paperId` - 试卷ID
- **响应示例**：
```json
{
  "success": true,
  "data": [
    {
      "id": 1,
      "paperId": 1,
      "questionId": 1,
      "sortOrder": 1,
      "score": 20,
      "questionType": "single_choice"
    }
  ],
  "message": "获取试卷题目列表成功"
}
```

### 5.2 获取试卷题目详情
- **接口地址**：`GET /api/paper-questions/{id}`
- **功能描述**：获取试卷题目详情
- **路径参数**：`id` - 试卷题目ID

### 5.3 创建试卷题目
- **接口地址**：`POST /api/paper-questions`
- **功能描述**：创建试卷题目关联
- **请求体**：
```json
{
  "paperId": 1,
  "questionId": 1,
  "sortOrder": 1,
  "score": 20,
  "questionType": "single_choice"
}
```

### 5.4 批量创建试卷题目
- **接口地址**：`POST /api/paper-questions/batch`
- **功能描述**：批量创建试卷题目关联
- **请求体**：
```json
[
  {
    "paperId": 1,
    "questionId": 1,
    "sortOrder": 1,
    "score": 20,
    "questionType": "single_choice"
  },
  {
    "paperId": 1,
    "questionId": 2,
    "sortOrder": 2,
    "score": 30,
    "questionType": "multiple_choice"
  }
]
```

### 5.5 更新试卷题目
- **接口地址**：`PUT /api/paper-questions/{id}`
- **功能描述**：更新试卷题目信息
- **路径参数**：`id` - 试卷题目ID

### 5.6 删除试卷题目
- **接口地址**：`DELETE /api/paper-questions/{id}`
- **功能描述**：删除试卷题目关联
- **路径参数**：`id` - 试卷题目ID

### 5.7 删除试卷所有题目
- **接口地址**：`DELETE /api/paper-questions/paper/{paperId}`
- **功能描述**：删除指定试卷的所有题目关联
- **路径参数**：`paperId` - 试卷ID

---

## 状态码说明

- **200**：请求成功
- **400**：请求参数错误
- **404**：资源不存在
- **500**：服务器内部错误

## 注意事项

1. 所有接口都支持跨域访问
2. 时间格式统一使用ISO 8601格式（如：2024-01-01T10:00:00）
3. 文件上传路径需要根据实际部署环境调整
4. 用户ID和教师ID暂时使用数字ID，后续可扩展为完整的用户系统
5. 任务状态说明：
   - `pending`：待开始
   - `active`：进行中
   - `completed`：已完成
6. 提交状态说明：
   - `not_submitted`：未提交
   - `submitted`：已提交
7. 批改状态说明：
   - `pending`：待批改
   - `graded`：已批改 